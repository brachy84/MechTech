name: Test

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version'
        type: string
        default: '0.1.0'
        required: false
      overwrite-w:
        description: 'If existing version should be overriden'
        default: false
        required: false
        type: boolean

env:
  CHANGELOG_LOCATION: "build/gh_changelog.md"

jobs:
  test-1:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
      - name: Print name
        run: |
          NAME="${GITHUB_REPOSITORY#*/}-${{ github.event.inputs.version }}"
          echo $NAME
      - name: Get Changelog
        run: |
          mkdir -p build
          RELEASE_URL="https://api.github.com/repos/CleanroomMC/ModularUI/releases/tags/v2.4.1"
          RELEASE_JSON=$(curl -sSL $RELEASE_URL)
          CHANGELOG="$(echo $RELEASE_JSON | jq -r '.body')"
          if [ "$CHANGELOG" == "null" ]; then
            echo "No changelog found" > $CHANGELOG_LOCATION
          else
            echo "$CHANGELOG" > $CHANGELOG_LOCATION
          fi
      - name: Print Changelog
        run: cat "$CHANGELOG_LOCATION"
